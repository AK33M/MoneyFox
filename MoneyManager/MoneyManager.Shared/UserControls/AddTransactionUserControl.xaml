<UserControl
    x:Class="MoneyManager.UserControls.AddTransactionUserControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:converter="using:MoneyManager.Converter"
    mc:Ignorable="d"
    d:DesignWidth="400" d:DesignHeight="600"
    DataContext="{Binding AddTransactionView, Source={StaticResource Locator}}">

    <UserControl.Resources>
        <converter:ThemedImageConverter x:Key="ThemedImageConverter"/>
        <converter:DateTimeToDateTimeOffsetConverter x:Key="DateTimeToDateTimeOffsetConverter" />
        <converter:BooleanToVisibilityConverter x:Key="BooleanVisibilityConverter" />
        <DataTemplate x:Key="ComboBoxTemplate">
            <StackPanel Margin="0,0,0,12">
                <TextBlock Text="{Binding Name}" FontSize="24" />
            </StackPanel>
        </DataTemplate>
    </UserControl.Resources>

    <ScrollViewer>
        <StackPanel Margin="12,0">
            <ComboBox Header="Charged Account" x:Uid="ChargedAccount"
                      ItemTemplate="{StaticResource ComboBoxTemplate}"
                      ItemsSource="{Binding AllAccounts, Mode=TwoWay}"                       
                      SelectedItem="{Binding SelectedTransaction.ChargedAccount, Mode=TwoWay}"/>
            <TextBox Text="{Binding SelectedTransaction.Amount, Mode=TwoWay}" Header="Amount"
                     InputScope="Number" TextAlignment="Right" />
            <Grid>
                <TextBox Header="Category" x:Uid="CategoryHeader"
                         Text="{Binding SelectedTransaction.Category.Name, UpdateSourceTrigger=PropertyChanged}"
                         GotFocus="OpenSelectCategoryDialog"
                         IsReadOnly="True"/>
                <Image Height="35"  Width="35" 
                           Source="/Images/light/close.png"
                           Margin="338,38,3,11"
                           Tapped="ResetCategory"/>
            </Grid>
            <DatePicker Date="{Binding SelectedTransaction.Date, Converter={StaticResource DateTimeToDateTimeOffsetConverter}, Mode=TwoWay}"
                        Margin="0,12,0,0" Header="Date" 
                        x:Uid="DateHeader"/>
            <TextBox Header="Note"
                     Text="{Binding SelectedTransaction.Note, Mode=TwoWay}" />
            <ToggleSwitch Header="Repeat" x:Uid="Repeat"
                          VerticalAlignment="Stretch"
                          IsOn="{Binding SelectedTransaction.IsRecurring, Mode=TwoWay}" />
            <StackPanel Visibility="{Binding SelectedTransaction.IsRecurring, Converter={StaticResource BooleanVisibilityConverter}}">
                <ComboBox Header="Reccurence" x:Uid="RecurrenceHeader"
                          SelectedIndex="{Binding Recurrence, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                    <ComboBoxItem Content="weekly" x:Uid="WeeklyContent" />                
                    <ComboBoxItem Content="monthly" x:Uid="MonthlyContent" />
                </ComboBox>
            </StackPanel>
        </StackPanel>
    </ScrollViewer>
</UserControl>